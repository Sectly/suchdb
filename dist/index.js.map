{"version":3,"file":"index.js","sources":["../src/index.js"],"sourcesContent":["/**\n* @sectly-studios/suchdb | 1.0.15 (Fri Oct 06 2023)\n* An simple, dependency free, require &amp; go node.js and browser database\n* Auhtor: Sectly (Sectly@sectly.online)\n* Licence: MPL-2.0, This Source Code Form is subject to the terms of the Mozilla Public License, v. 2.0. If a copy of the MPL was not distributed with this file, You can obtain one at https://mozilla.org/MPL/2.0/.\n* NPM: https://www.npmjs.com/package/@sectly-studios/suchdb\n*/\n\n// Source:\n(function (exports) {\n  'use strict'\n\n  function SuchDBMaster (options, isNode) {\n    const version = 'V1.0.15'\n    const suchdb = {}\n    let events = []\n\n    options = options || {}\n    isNode = isNode || false\n\n    // Core Functions:\n\n    function nodeify (defaultvalue, nodevalue) {\n      if (isNode) {\n        return nodevalue || null\n      } else {\n        return defaultvalue || null\n      }\n    }\n\n    function getoption (data, defaultvalue) {\n      const name = data.name || false\n      const base = data.base || false\n\n      if (options && typeof options === 'object' && Object.keys(options).length > 0) {\n        if (base) {\n          const checkbase = options[base] !== 'undefined' ? options[base] : (options[base] = null)\n\n          if (checkbase) {\n            return typeof options[base][name] !== 'undefined' ? options[base][name] : (options[base][name] = defaultvalue)\n          } else {\n            return defaultvalue\n          }\n        } else {\n          return typeof options[name] !== 'undefined' ? options[name] : (options[name] = defaultvalue)\n        }\n      } else {\n        return defaultvalue\n      }\n    }\n\n    suchdb.options = {\n      master: getoption({ name: 'master', base: false }, nodeify('suchdb_data', 'data')),\n      autosave: getoption({ name: 'autosave', base: false }, nodeify(false, true)),\n      autoload: getoption({ name: 'autoload', base: false }, nodeify(false, false)),\n      encrypt: {\n        enabled: getoption({ name: 'enabled', base: 'encrypt' }, nodeify(false, true)),\n        key: getoption({ name: 'key', base: 'encrypt' }, nodeify('SuchDB', 'SuchDB_Key'))\n      },\n      autobackup: getoption({ name: 'autobackup', base: false }, nodeify(false, false)),\n      logging: getoption({ name: 'logging', base: false }, nodeify(false, false)),\n      logging_custom: getoption({ name: 'logging_custom', base: false }, nodeify(false, false))\n    }\n\n    suchdb.isNode = isNode || false\n\n    if (suchdb.isNode) {\n      suchdb.nodeDriver = {\n        fs: require('fs')\n      }\n    }\n\n    let store = {}\n\n    const SuchDBEncryption = {\n      encrypt: function (content, key) {\n        const result = []\n        const keyLen = key.length\n        for (let i = 0; i < content.length; i++) {\n          const keyOffset = i % keyLen\n          const calAscii = (content.charCodeAt(i) + key.charCodeAt(keyOffset))\n          result.push(calAscii)\n        }\n        return JSON.stringify(result)\n      },\n\n      decrypt: function (content, key) {\n        const result = []\n        let str = ''\n        const codesArr = JSON.parse(content)\n        const keyLen = key.length\n        for (var i = 0; i < codesArr.length; i++) {\n          const keyOffset = i % keyLen\n          const calAscii = (codesArr[i] - key.charCodeAt(keyOffset))\n          result.push(calAscii)\n        }\n        for (var i = 0; i < result.length; i++) {\n          const ch = String.fromCharCode(result[i]); str += ch\n        }\n        return str\n      }\n    }\n\n    function __removeEvent (id) {\n      try {\n        events = events.filter((element) => `${element.id}` !== `${id}`)\n      } catch (error) {\n        console.log(error)\n      }\n    }\n\n    function __emit (event) {\n      try {\n        events.forEach(function (data) {\n          if (data.event === event) {\n            try {\n              event.callback()\n            } catch (error) {\n              console.log(error)\n            }\n\n            if (data.once) {\n              __removeEvent(data.id)\n            }\n          }\n        })\n      } catch (error) {\n        console.log(error)\n      }\n    }\n\n    function __log (message) {\n      try {\n        if (suchdb.options.logging) {\n          if (suchdb.options.logging_custom != false) {\n            suchdb.options.logging_custom(message)\n          } else {\n            console.log(`[SuchDB ${version} at ${new Date().toTimeString()}] ${message}`)\n          }\n        }\n      } catch (error) {\n        console.log(error)\n      }\n    }\n\n    function __backup (dataToBackup) {\n      try {\n        if (suchdb.options.autobackup) {\n          dataToBackup = dataToBackup || JSON.stringify({ error: 'SuchDB Data Backup Error!' })\n\n          if (suchdb.isNode) {\n            suchdb.nodeDriver.fs.writeFileSync(`${suchdb.options.master}.backup.suchdb`, dataToBackup)\n          } else {\n            localStorage.setItem(`backup_${suchdb.options.master}`, JSON.stringify(dataToBackup))\n          }\n        }\n        __log('Successfully backed up!')\n      } catch (error) {\n        console.log(error)\n      }\n    }\n\n    function __loadBackup (overwrite) {\n      try {\n        if (suchdb.options.autobackup) {\n          overwrite = overwrite || false\n\n          let dataFromBackup = ''\n\n          if (suchdb.isNode) {\n            dataFromBackup = suchdb.nodeDriver.fs.readFileSync(`${suchdb.options.master}.backup.suchdb`) || ''\n          } else {\n            dataFromBackup = localStorage.getItem(`backup_${suchdb.options.master}`) || ''\n          }\n\n          if (suchdb.options.encrypt.enabled && typeof suchdb.options.encrypt.key === 'string') {\n            dataFromBackup = SuchDBEncryption.decrypt(dataFromBackup, suchdb.options.encrypt.key)\n          }\n\n          if (overwrite) {\n            store = JSON.parse(dataFromBackup)\n          } else {\n            store = Object.assign(store, JSON.parse(dataFromBackup))\n          }\n        }\n        __log('Successfully loaded a backup of the database!')\n      } catch (error) {\n        console.log(error)\n      }\n    }\n\n    function __save () {\n      try {\n        let dataToSave = store || JSON.stringify({ error: 'SuchDB Data Save Error!' })\n\n        if (suchdb.options.encrypt.enabled && typeof suchdb.options.encrypt.key === 'string') {\n          dataToSave = SuchDBEncryption.encrypt(JSON.stringify(dataToSave), suchdb.options.encrypt.key)\n        }\n\n        if (suchdb.isNode) {\n          suchdb.nodeDriver.fs.writeFileSync(`${suchdb.options.master}.suchdb`, dataToSave)\n        } else {\n          localStorage.setItem(suchdb.options.master, JSON.stringify(dataToSave))\n        }\n\n        __log('Successfully saved the database!')\n\n        __backup(dataToSave)\n      } catch (error) {\n        console.log(error)\n      }\n    }\n\n    function __load (overwrite) {\n      try {\n        overwrite = overwrite || false\n\n        let dataToLoad = ''\n\n        if (suchdb.isNode) {\n          dataToLoad = suchdb.nodeDriver.fs.readFileSync(`${suchdb.options.master}.suchdb`) || ''\n\n          if (suchdb.options.encrypt.enabled && typeof suchdb.options.encrypt.key === 'string') {\n            dataToLoad = SuchDBEncryption.decrypt(dataToLoad, suchdb.options.encrypt.key)\n          }\n\n          if (overwrite) {\n            store = JSON.parse(dataToLoad)\n          } else {\n            store = Object.assign(store, JSON.parse(dataToLoad))\n          }\n        } else {\n          dataToLoad = localStorage.getItem(suchdb.options.master) || ''\n\n          if (suchdb.options.encrypt.enabled && typeof suchdb.options.encrypt.key === 'string') {\n            dataToLoad = SuchDBEncryption.decrypt(dataToLoad, suchdb.options.encrypt.key)\n          }\n\n          if (overwrite) {\n            store = JSON.parse(dataToLoad)\n          } else {\n            store = Object.assign(store, JSON.parse(dataToLoad))\n          }\n        }\n\n        __log('Successfully loaded the database!')\n\n        _save()\n      } catch (error) {\n        console.log(error)\n      }\n    }\n\n    function _save () {\n      if (suchdb.options.autosave) {\n        __save()\n      }\n    }\n\n    function Init () {\n      __log('Initializing...')\n      __emit('init')\n      if (suchdb.options.autoload) {\n        __load(true)\n      }\n      suchdb.set('SuchDB_Version', version)\n      __emit('ready')\n      __log('Initialized!')\n    }\n\n    // Base Functions:\n\n    /**\n    * Set/Add Data To The Database\n    *\n    * @param {string} key\n    * @param {any} value\n    */\n\n    suchdb.set = function (key, value) {\n      if (typeof key === 'string' && value) {\n        store[key] = JSON.stringify(value)\n        __log(`Updated ${key} with ${value}`)\n        __emit('set')\n      }\n      _save()\n    }\n\n    /**\n    * Get/Grab Data From The Database\n    *\n    * @param {string} key\n    */\n\n    suchdb.get = function (key) {\n      if (typeof key === 'string') {\n        const getdata = typeof store[key] !== 'undefined' ? store[key] : (store[key] = JSON.stringify('ERROR, Date Not Found!'))\n        __log(`Fetching ${key}...`)\n        __emit('get')\n        return JSON.parse(getdata) || { error: 'Data Fetch Failed!' }\n      }\n    }\n\n    /**\n    * Remove/Delete Data From The Database\n    *\n    * @param {string} key\n    */\n\n    suchdb.remove = function (key) {\n      if (typeof key === 'string') {\n        delete store[key]\n        __log(`Removed ${key}.`)\n        __emit('remove')\n      }\n      _save()\n    }\n\n    /**\n    * Clear/Delete All Data In The Database\n    */\n\n    suchdb.clear = function () {\n      store = {}\n      __log(`Cleared ${key}.`)\n      __emit('clear')\n      _save()\n    }\n\n    /**\n    * Get Database Keys\n    */\n\n    suchdb.keys = function () {\n      __log('Fetching keys...')\n      __emit('keys')\n      return Object.keys(store)\n    }\n\n    /**\n    * Get Database Values\n    */\n\n    suchdb.values = function () {\n      __log('Fetching values...')\n      __emit('values')\n      return Object.values(store)\n    }\n\n    /**\n    * Get Database Entries\n    */\n\n    suchdb.entries = function () {\n      __log('Fetching entries...')\n      __emit('entries')\n      return Object.entries(store)\n    }\n\n    /**\n    * Loop Through All Data In The Database\n    *\n    * @param {function} callback(key, value)\n    */\n\n    suchdb.forEach = function (callback) {\n      __log('Looping through the database...')\n      __emit('foreach')\n      for (const key in store) {\n        if (store.hasOwnProperty(key)) {\n          callback(key, store[key])\n        }\n      }\n    }\n\n    /**\n    * Get Database Size\n    */\n\n    suchdb.size = function () {\n      __log(`The database size is ${Object.keys(store).length}`)\n      __emit('size')\n      return Object.keys(store).length\n    }\n\n    /**\n    * Check If Database Is Empty\n    */\n\n    suchdb.isEmpty = function () {\n      __log(`The database is empty: ${Object.keys(store).length == 0}`)\n      __emit('isempty')\n      return Object.keys(store).length == 0\n    }\n\n    /**\n    * Check If Database Has Data\n    */\n\n    suchdb.has = function (key) {\n      __log(`The database has data: ${Object.hasOwnProperty(store, key)}`)\n      __emit('has')\n      return Object.hasOwnProperty(store, key)\n    }\n\n    /**\n    * Lookup Data In The Database\n    *\n    * @param {any} value\n    */\n\n    suchdb.lookup = function (value) {\n      __log(`Looking up ${value}...`)\n      __emit('lookup')\n      return Object.values(store).includes(value)\n    }\n\n    /**\n    * Sort the database\n    *\n    * @param {string} key\n    * @param {boolean} reverse\n    */\n\n    suchdb.sort = function (key, reverse) {\n      __log(`Sorting the database in ${key} and in reverse: ${reverse}`)\n      __emit('sort')\n      store = store.sort(function (such, db) {\n        if (key) {\n          if (reverse) {\n            return such[key] - db[key]\n          } else {\n            return db[key] - such[key]\n          }\n        } else {\n          if (reverse) {\n            return such - db\n          } else {\n            return db - such\n          }\n        }\n      })\n      _save()\n    }\n\n    /**\n    * Find An Entry\n    * @param {any} query\n    */\n\n    suchdb.find = function (query = { name: '', value: '' }) {\n      __log(`Finding an entry in the database with the query of ${query}`)\n      __emit('find')\n      suchdb.forEach((key, value) => {\n        if (key[query.name] === query.value) {\n          __log(`Found ${{ key, value }}`)\n          return { key, value }\n        }\n      })\n\n      return null\n    }\n\n    suchdb.findMultiple = function (query = { name: '', value: '' }) {\n      __log(`Finding multiple entries in the database with the query of ${query}`)\n      __emit('findmultiple')\n      const results = []\n      suchdb.forEach((key, value) => {\n        if (key[query.name] === query.value) {\n          __log(`Found ${{ key, value }}`)\n          results.push({ key, value })\n        }\n      })\n\n      __log(`Results: ${results}`)\n\n      return results\n    }\n\n    /**\n    * Port Json To The Database\n    * @param {any} json\n    * @param {boolean} overwrite\n    */\n\n    suchdb.port = function (json, overwrite) {\n      __log(`Porting database with ${json} ovewrite: ${overwrite}`)\n      __emit('port')\n      if (overwrite) {\n        store = JSON.parse(json)\n      } else {\n        store = Object.assign(store, JSON.parse(json))\n      }\n      _save()\n    }\n\n    /**\n    * Save Database To:\n    * > localStorage\n    * > node-fs\n    */\n\n    suchdb.save = function () {\n      __log('Saving the database...')\n      __emit('save')\n      __save()\n    }\n\n    /**\n    * Load Database From:\n    * > localStorage\n    * > node-fs\n    */\n\n    suchdb.load = function (overwrite) {\n      __log('Loading the database...')\n      __emit('load')\n      __load(overwrite)\n    }\n\n    /**\n    * Backup Database To:\n    * > localStorage\n    * > node-fs\n    */\n\n    suchdb.saveBackup = function () {\n      __log('Saving a backup of the database...')\n      __emit('savebackup')\n      __backup(store)\n    }\n\n    /**\n    * Backup Database From:\n    * > localStorage\n    * > node-fs\n    */\n\n    suchdb.loadBackup = function (overwrite) {\n      __log(`Loading a backup of the database overwrite: ${overwrite}`)\n      __emit('loadbackup')\n      __loadBackup(overwrite)\n    }\n\n    /**\n    * Get Raw Database Data\n    */\n\n    suchdb.raw = function () {\n      __log('Getting the database in a raw format (No encryption)')\n      __emit('raw')\n      return store || {}\n    }\n\n    /**\n    * Get A List Of Database Events\n    */\n\n    suchdb.getEvents = function () {\n      __log('Fetching a list of events...')\n\n      const eventList = []\n      const suchdbKeys = Object.keys(suchdb) || {}\n\n      suchdbKeys.forEach(function (key) {\n        const eventName = `${key}`.toLowerCase()\n\n        eventList.push(eventName)\n      })\n    }\n\n    /**\n    * Get Database Events\n    */\n\n    suchdb.events = events\n\n    /**\n    * Create an new on event listener\n    */\n\n    suchdb.on = function (event, callback) {\n      const id = new Date().valueOf()\n\n      __log(`New on listener: ${id}`)\n\n      events.push({ event: `${event}`, id: `${id}`, callback, once: false })\n\n      return id\n    }\n\n    /**\n    * Create an new once event listener\n    */\n\n    suchdb.once = function (event, callback) {\n      const id = new Date().valueOf()\n\n      __log(`New once listener: ${id}`)\n\n      events.push({ event: `${event}`, id: `${id}`, callback, once: true })\n\n      return id\n    }\n\n    /**\n    * Delete an on/once event listener\n    */\n\n    suchdb.off = function (id) {\n      __log(`Removed listener: ${id}`)\n      __removeEvent(`${id}`)\n    }\n\n    // Main Functions:\n\n    Init()\n\n    return suchdb || null\n  }\n\n  /**\n  * SuchDB\n  *\n  * @param {Object} options\n  */\n\n  function Boot (options) {\n    let isNode = false\n\n    if (typeof window === 'undefined') {\n      isNode = true\n    }\n\n    return SuchDBMaster(options, isNode)\n  }\n\n  var exports = exports || {}\n  var module = module || {}\n\n  exports.SuchDB = function SuchDB (options) {\n    return Boot(options)\n  }\n\n  module.exports = {\n    SuchDB: Boot\n  }\n})(typeof exports === 'undefined' ? this.SuchDB = {} : exports)\n\n// SuchDB, Auhtor: Sectly (Sectly@sectly.online) | MPL-2.0 Licence.\n"],"names":["exports","Boot","options","isNode","window","version","suchdb","events","nodeify","defaultvalue","nodevalue","getoption","data","name","base","Object","keys","length","master","autosave","autoload","encrypt","enabled","key","autobackup","logging","logging_custom","nodeDriver","fs","require","store","SuchDBEncryption","content","result","keyLen","i","keyOffset","calAscii","charCodeAt","push","JSON","stringify","decrypt","str","codesArr","parse","String","fromCharCode","__removeEvent","id","filter","element","error","console","log","__emit","event","forEach","callback","once","__log","message","Date","toTimeString","__backup","dataToBackup","writeFileSync","localStorage","setItem","__save","dataToSave","__load","overwrite","dataToLoad","readFileSync","assign","getItem","_save","set","value","get","getdata","remove","clear","values","entries","hasOwnProperty","size","isEmpty","has","lookup","includes","sort","reverse","such","db","find","query","findMultiple","results","port","json","save","load","saveBackup","loadBackup","dataFromBackup","__loadBackup","raw","getEvents","toLowerCase","on","valueOf","off","SuchDBMaster","module","SuchDB","this"],"mappings":"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"}